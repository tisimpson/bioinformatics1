"0","library(cluster)"
"0",""
"0","#check to see that gthe chips segregate by genotype"
"0","cl <- kmeans(t(enrich),2);"
"0",""
"0","#cluster the top 100 differentially expressed genes"
"0","cl_group <- diffexp_final[1:100,]"
"0",""
"0","colnames(cl_group)[1] <- 'ID'"
"0",""
"0","#get the ids"
"0","ids <- cl_group$ID;"
"0",""
"0","#extract only those expression values"
"0","cl_enrich <- enrich[ids,];"
"0",""
"0","#use hierarchical clustering to partition the differentially expressed genes"
"0","hc <- hclust(dist(cl_enrich),method='complete');"
"0",""
"0","myLabels = unique(paste(pData(data)$condition,pData(data)$sample,sep=""-""))"
"0",""
"0","#show the expression groupings in a heatmap"
"0","heatmap(as.matrix(cl_enrich),Rowv=hc$order,labCol = myLabels)"
