"0","pca <- prcomp(t(exprs)); # Note, we are doing PCA by chip i.e. trying to see where the variation is between the chips"
"0",""
"0","#look at where the variation is across the Principal Components"
"0","summary(pca);"
"1","Importance of components:
"
"1","                      "
"1","     PC1"
"1","     PC2"
"1","      PC3"
"1","     PC4"
"1","     PC5"
"1","     PC6"
"1","     PC7"
"1","     PC8"
"1","     PC9"
"1","    PC10"
"1","    PC11"
"1","    PC12"
"1","    PC13"
"1","    PC14"
"1","    PC15"
"1","      PC16"
"1","
Standard deviation    "
"1"," 32.2081"
"1"," 23.2813"
"1"," 11.63801"
"1"," 8.04606"
"1"," 6.44874"
"1"," 4.97401"
"1"," 4.85757"
"1"," 4.52255"
"1"," 4.32697"
"1"," 3.98507"
"1"," 3.90758"
"1"," 3.84190"
"1"," 3.70700"
"1"," 3.60941"
"1"," 3.45088"
"1"," 6.202e-14"
"1","
Proportion of Variance"
"1","  0.5204"
"1","  0.2719"
"1","  0.06795"
"1"," 0.03248"
"1"," 0.02086"
"1"," 0.01241"
"1"," 0.01184"
"1"," 0.01026"
"1"," 0.00939"
"1"," 0.00797"
"1"," 0.00766"
"1"," 0.00741"
"1"," 0.00689"
"1"," 0.00654"
"1"," 0.00597"
"1"," 0.000e+00"
"1","
Cumulative Proportion "
"1","  0.5204"
"1","  0.7924"
"1","  0.86032"
"1"," 0.89279"
"1"," 0.91366"
"1"," 0.92607"
"1"," 0.93791"
"1"," 0.94817"
"1"," 0.95756"
"1"," 0.96553"
"1"," 0.97319"
"1"," 0.98060"
"1"," 0.98749"
"1"," 0.99403"
"1"," 1.00000"
"1"," 1.000e+00"
"1","
"
"0","#extract the principal components"
"0","pcs <- data.frame(pca$x);"
"0",""
"0","#add in the annotation data by merging (just for the first 2 principal components)"
"0","pcs <- merge(pcs[,1:2],pData(data),by=0);"
"0",""
"0","#plot the first two principal components"
"0","library(ggplot2);"
"0",""
"0","#plot by condition"
"0","ggplot(pcs,aes(PC1,PC2,colour=condition))+geom_point()+theme_bw()+scale_colour_manual(values=c('red','gray'));"
